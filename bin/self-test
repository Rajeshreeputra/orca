#!/usr/bin/env bash

# ORCA self test script.

set -e

cd "$(dirname "$0")/.."

composer install

echo && composer phpcs
echo && composer phpunit
echo && composer phpmd

# Symlink an example project into place as a test SUT.
if [[ ! -d "../example" ]]; then
  ln -s orca/tests/fixtures/projects/example ../
fi

# Avoid testing locally with a stale cache.
./bin/orca cache:clear

ORCA_PROJECTS_CONFIG="tests/fixtures/config/projects.yml" \
  ./bin/travis/script drupal/example

echo && times
